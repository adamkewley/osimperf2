#!/bin/bash
set -eo pipefail

WORKSPACE=$(dirname $(realpath "$0"))

echo "Setup RajagopalDropUndamped benchmark at $WORKSPACE"

models_dir=$(realpath $WORKSPACE/../../opensim-models)
echo "Copy models from $models_dir"

cp -r $models_dir/Geometry $WORKSPACE/Geometry

for model in $(find $WORKSPACE -name Rajagopal2016.osim); do
	echo "Set fiber damping in $model"
	sed -i -e s/'fiber_damping>0.1<\/fiber_damping'/'fiber_damping>0.01<\/fiber_damping'/g $model
	cat $model | grep fiber_damping
	echo
done

binary=ToolPerf
results=$WORKSPACE/benchmark-result_RajagopalDropUndamped.csv
log=$WORKSPACE/log.txt

echo "Run RajagopalDropUndamped model"

$binary --model Rajagopal2016.osim --out $results --run "2"
